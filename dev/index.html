<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · ARS.jl</title><meta name="title" content="Home · ARS.jl"/><meta property="og:title" content="Home · ARS.jl"/><meta property="twitter:title" content="Home · ARS.jl"/><meta name="description" content="Documentation for ARS.jl."/><meta property="og:description" content="Documentation for ARS.jl."/><meta property="twitter:description" content="Documentation for ARS.jl."/><meta property="og:url" content="https://Eliassj.github.io/ARS.jl/"/><meta property="twitter:url" content="https://Eliassj.github.io/ARS.jl/"/><link rel="canonical" href="https://Eliassj.github.io/ARS.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.svg" alt="ARS.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>ARS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Showcase"><span>Showcase</span></a></li><li><a class="tocitem" href="#Truncated-density"><span>Truncated density</span></a></li></ul></li><li><a class="tocitem" href="benchmarks/">Benchmarks</a></li><li><a class="tocitem" href="api/">Public API</a></li><li><a class="tocitem" href="devdocs/">Internals</a></li><li><a class="tocitem" href="references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ARS"><a class="docs-heading-anchor" href="#ARS">ARS</a><a id="ARS-1"></a><a class="docs-heading-anchor-permalink" href="#ARS" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/Eliassj/ARS.jl">ARS</a>.</p><p>This package implements univariate adaptive rejection sampling as specified by Gilks &amp; Wild [<a href="references/#Gilks_Wild_1992">1</a>].</p><h2 id="Showcase"><a class="docs-heading-anchor" href="#Showcase">Showcase</a><a id="Showcase-1"></a><a class="docs-heading-anchor-permalink" href="#Showcase" title="Permalink"></a></h2><p>ARS allows you to sample from unnormalized <a href="https://en.wikipedia.org/wiki/Logarithmically_concave_function">logarithmically concave</a> distributions. In the following example we will sample from an unnormalized <a href="https://en.wikipedia.org/wiki/Normal_distribution">normal distribution</a>.</p><pre><code class="language-julia hljs">using ARS, CairoMakie, Distributions, Random
set_theme!(theme_minimal())
update_theme!(linewidth = 6)
update_theme!(fonts = (; regular = &quot;DejaVu Sans&quot;))
Random.seed!(1)</code></pre><p>Lets use a normal distribution centered on <span>$\pi$</span> with standard deviation 2.</p><pre><code class="language-julia hljs">const mu::Float64 = π
const sigma::Float64 = 2.0

# Define a normal distribution without the normalizing terms.
f(x) = exp(-((x - mu)^2) / (2 * sigma^2))

# Use the normal distribution from Distributions.jl for verification.
normal(x) = pdf(Normal(mu, sigma), x)

l, u = mu - sigma * 4, mu + sigma * 4
fig, ax, p = lines(l..u, f, label = &quot;Unnormalized density&quot;)
lines!(ax, l..u, normal, label = &quot;Actual normal distribution&quot;)
axislegend(ax)</code></pre><img src="index-7f4bcca4.svg" alt="Example block output"/><p>Let&#39;s imagine we did not know the actual normalizing constant for the normal distribution above. In order to sample from it using ARS, we first define an objective function using <a href="api/#ARS.Objective">ARS.Objective</a>. By default, automatic differentiation through <a href="https://github.com/chalk-lab/Mooncake.jl">Mooncake.jl</a> is used to calculate the derivative of the function to be sampled from.</p><p>First, we need to supply the function in its log form. For illustration purposes, we simply do <code>log(f(x))</code>.</p><pre><code class="language-julia hljs">f_log(x) = log(f(x))
obj = ARS.Objective(f_log)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ARS.Objective{typeof(Main.f_log), ARS.var&quot;#1#2&quot;{typeof(Main.f_log), DifferentiationInterfaceMooncakeExt.MooncakeGradientPrep{Tuple{typeof(Main.f_log), ADTypes.AutoMooncake{Nothing}, Float64, Tuple{}}, Mooncake.Cache{Mooncake.DerivedRule{Tuple{typeof(Main.f_log), Float64}, Tuple{Mooncake.CoDual{typeof(Main.f_log), Mooncake.NoFData}, Mooncake.CoDual{Float64, Mooncake.NoFData}}, Mooncake.CoDual{Float64, Mooncake.NoFData}, Tuple{Float64}, Tuple{Mooncake.NoRData, Float64}, false, Val{2}}, Nothing, Tuple{Mooncake.NoTangent, Float64}}}, ADTypes.AutoMooncake{Nothing}}}(Main.f_log, ARS.var&quot;#1#2&quot;{typeof(Main.f_log), DifferentiationInterfaceMooncakeExt.MooncakeGradientPrep{Tuple{typeof(Main.f_log), ADTypes.AutoMooncake{Nothing}, Float64, Tuple{}}, Mooncake.Cache{Mooncake.DerivedRule{Tuple{typeof(Main.f_log), Float64}, Tuple{Mooncake.CoDual{typeof(Main.f_log), Mooncake.NoFData}, Mooncake.CoDual{Float64, Mooncake.NoFData}}, Mooncake.CoDual{Float64, Mooncake.NoFData}, Tuple{Float64}, Tuple{Mooncake.NoRData, Float64}, false, Val{2}}, Nothing, Tuple{Mooncake.NoTangent, Float64}}}, ADTypes.AutoMooncake{Nothing}}(Main.f_log, DifferentiationInterfaceMooncakeExt.MooncakeGradientPrep{Tuple{typeof(Main.f_log), ADTypes.AutoMooncake{Nothing}, Float64, Tuple{}}, Mooncake.Cache{Mooncake.DerivedRule{Tuple{typeof(Main.f_log), Float64}, Tuple{Mooncake.CoDual{typeof(Main.f_log), Mooncake.NoFData}, Mooncake.CoDual{Float64, Mooncake.NoFData}}, Mooncake.CoDual{Float64, Mooncake.NoFData}, Tuple{Float64}, Tuple{Mooncake.NoRData, Float64}, false, Val{2}}, Nothing, Tuple{Mooncake.NoTangent, Float64}}}(Val{Tuple{typeof(Main.f_log), ADTypes.AutoMooncake{Nothing}, Float64, Tuple{}}}(), Mooncake.Cache{Mooncake.DerivedRule{Tuple{typeof(Main.f_log), Float64}, Tuple{Mooncake.CoDual{typeof(Main.f_log), Mooncake.NoFData}, Mooncake.CoDual{Float64, Mooncake.NoFData}}, Mooncake.CoDual{Float64, Mooncake.NoFData}, Tuple{Float64}, Tuple{Mooncake.NoRData, Float64}, false, Val{2}}, Nothing, Tuple{Mooncake.NoTangent, Float64}}(Mooncake.DerivedRule{Tuple{typeof(Main.f_log), Float64}, Tuple{Mooncake.CoDual{typeof(Main.f_log), Mooncake.NoFData}, Mooncake.CoDual{Float64, Mooncake.NoFData}}, Mooncake.CoDual{Float64, Mooncake.NoFData}, Tuple{Float64}, Tuple{Mooncake.NoRData, Float64}, false, Val{2}}(MistyClosure (::Mooncake.CoDual{typeof(Main.f_log), Mooncake.NoFData}, ::Mooncake.CoDual{Float64, Mooncake.NoFData})::Mooncake.CoDual{Float64, Mooncake.NoFData}-&gt;◌, Base.RefValue{MistyClosures.MistyClosure{Core.OpaqueClosure{Tuple{Float64}, Tuple{Mooncake.NoRData, Float64}}}}(MistyClosure (::Float64)::Tuple{Mooncake.NoRData, Float64}-&gt;◌), Val{2}()), nothing, (Mooncake.NoTangent(), 0.0))), ADTypes.AutoMooncake{Nothing}(nothing)))</code></pre><p>We then define the sampler itself providing the initial points for the hull as well as the desired domain. Initial points needs to be at opposing sides of the function maximum.</p><pre><code class="language-julia hljs">sam = ARS.ARSampler(obj, [-2., 4.], (-Inf, Inf))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ARS.ARSampler{Float64, typeof(Main.f_log), ARS.var&quot;#1#2&quot;{typeof(Main.f_log), DifferentiationInterfaceMooncakeExt.MooncakeGradientPrep{Tuple{typeof(Main.f_log), ADTypes.AutoMooncake{Nothing}, Float64, Tuple{}}, Mooncake.Cache{Mooncake.DerivedRule{Tuple{typeof(Main.f_log), Float64}, Tuple{Mooncake.CoDual{typeof(Main.f_log), Mooncake.NoFData}, Mooncake.CoDual{Float64, Mooncake.NoFData}}, Mooncake.CoDual{Float64, Mooncake.NoFData}, Tuple{Float64}, Tuple{Mooncake.NoRData, Float64}, false, Val{2}}, Nothing, Tuple{Mooncake.NoTangent, Float64}}}, ADTypes.AutoMooncake{Nothing}}}(ARS.Objective{typeof(Main.f_log), ARS.var&quot;#1#2&quot;{typeof(Main.f_log), DifferentiationInterfaceMooncakeExt.MooncakeGradientPrep{Tuple{typeof(Main.f_log), ADTypes.AutoMooncake{Nothing}, Float64, Tuple{}}, Mooncake.Cache{Mooncake.DerivedRule{Tuple{typeof(Main.f_log), Float64}, Tuple{Mooncake.CoDual{typeof(Main.f_log), Mooncake.NoFData}, Mooncake.CoDual{Float64, Mooncake.NoFData}}, Mooncake.CoDual{Float64, Mooncake.NoFData}, Tuple{Float64}, Tuple{Mooncake.NoRData, Float64}, false, Val{2}}, Nothing, Tuple{Mooncake.NoTangent, Float64}}}, ADTypes.AutoMooncake{Nothing}}}(Main.f_log, ARS.var&quot;#1#2&quot;{typeof(Main.f_log), DifferentiationInterfaceMooncakeExt.MooncakeGradientPrep{Tuple{typeof(Main.f_log), ADTypes.AutoMooncake{Nothing}, Float64, Tuple{}}, Mooncake.Cache{Mooncake.DerivedRule{Tuple{typeof(Main.f_log), Float64}, Tuple{Mooncake.CoDual{typeof(Main.f_log), Mooncake.NoFData}, Mooncake.CoDual{Float64, Mooncake.NoFData}}, Mooncake.CoDual{Float64, Mooncake.NoFData}, Tuple{Float64}, Tuple{Mooncake.NoRData, Float64}, false, Val{2}}, Nothing, Tuple{Mooncake.NoTangent, Float64}}}, ADTypes.AutoMooncake{Nothing}}(Main.f_log, DifferentiationInterfaceMooncakeExt.MooncakeGradientPrep{Tuple{typeof(Main.f_log), ADTypes.AutoMooncake{Nothing}, Float64, Tuple{}}, Mooncake.Cache{Mooncake.DerivedRule{Tuple{typeof(Main.f_log), Float64}, Tuple{Mooncake.CoDual{typeof(Main.f_log), Mooncake.NoFData}, Mooncake.CoDual{Float64, Mooncake.NoFData}}, Mooncake.CoDual{Float64, Mooncake.NoFData}, Tuple{Float64}, Tuple{Mooncake.NoRData, Float64}, false, Val{2}}, Nothing, Tuple{Mooncake.NoTangent, Float64}}}(Val{Tuple{typeof(Main.f_log), ADTypes.AutoMooncake{Nothing}, Float64, Tuple{}}}(), Mooncake.Cache{Mooncake.DerivedRule{Tuple{typeof(Main.f_log), Float64}, Tuple{Mooncake.CoDual{typeof(Main.f_log), Mooncake.NoFData}, Mooncake.CoDual{Float64, Mooncake.NoFData}}, Mooncake.CoDual{Float64, Mooncake.NoFData}, Tuple{Float64}, Tuple{Mooncake.NoRData, Float64}, false, Val{2}}, Nothing, Tuple{Mooncake.NoTangent, Float64}}(Mooncake.DerivedRule{Tuple{typeof(Main.f_log), Float64}, Tuple{Mooncake.CoDual{typeof(Main.f_log), Mooncake.NoFData}, Mooncake.CoDual{Float64, Mooncake.NoFData}}, Mooncake.CoDual{Float64, Mooncake.NoFData}, Tuple{Float64}, Tuple{Mooncake.NoRData, Float64}, false, Val{2}}(MistyClosure (::Mooncake.CoDual{typeof(Main.f_log), Mooncake.NoFData}, ::Mooncake.CoDual{Float64, Mooncake.NoFData})::Mooncake.CoDual{Float64, Mooncake.NoFData}-&gt;◌, Base.RefValue{MistyClosures.MistyClosure{Core.OpaqueClosure{Tuple{Float64}, Tuple{Mooncake.NoRData, Float64}}}}(MistyClosure (::Float64)::Tuple{Mooncake.NoRData, Float64}-&gt;◌), Val{2}()), nothing, (Mooncake.NoTangent(), 0.0))), ADTypes.AutoMooncake{Nothing}(nothing))), ARS.UpperHull{Float64}([-0.7337005501361697, 0.7662994498638303], [1.2853981633974483, -0.21460183660255172], [-Inf, 1.0, Inf], [-2.0, 4.0], [1.350708254883096, 8.09032176797251], (-Inf, Inf)), ARS.LowerHull{Float64}([-2.2337005501361697], [0.5353981633974483], [-2.0, 4.0]))</code></pre><p>In order to retrieve samples, we use the <a href="api/#ARS.sample!"><code>ARS.sample!</code></a> function. As is indicated by the <code>!</code>, this function modifies the sampler itself in order to improve future sampling whenever a sample is rejected.</p><pre><code class="language-julia hljs">samples = ARS.sample!(sam, 1000);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1000-element Vector{Float64}:
  1.439713299314249
 -0.8943148644045692
  2.5520758369708525
  2.3557645435940757
  3.635438914948397
  3.0166969586443377
  7.5272435031658045
  2.1511992854849615
  3.7735020238687658
  2.1940148057903173
  ⋮
  5.222436492142635
  1.7849065876608348
  2.06210693498759
  2.0475243471820437
  1.7465925445151798
  3.768018078244205
  7.9743718344902925
  2.5593187163703095
  0.5746858116786882</code></pre><p>Lets compare the samples drawn from the sampler to the actual target distribution.</p><pre><code class="language-julia hljs">fig, ax, p = hist(samples, bins=100, normalization = :pdf, label = &quot;Samples&quot;, axis = (; title=&quot;1000 samples&quot;))
lines!(l..u, normal, label = &quot;Target distribution&quot;, color = :orange, linewidth = 3, alpha = 0.8)
axislegend(ax)</code></pre><img src="index-dc95a1dd.svg" alt="Example block output"/><p>Lets do one with more samples in order to verify that it actually approaches the target.</p><img src="index-7d453798.svg" alt="Example block output"/><h2 id="Truncated-density"><a class="docs-heading-anchor" href="#Truncated-density">Truncated density</a><a id="Truncated-density-1"></a><a class="docs-heading-anchor-permalink" href="#Truncated-density" title="Permalink"></a></h2><p>Lets try a truncated density such as the <a href="https://en.wikipedia.org/wiki/Beta_distribution">beta distribution</a>.</p><p>As before, we define the distribution without its normalizing terms as well as a function from <code>Distributions.jl</code> to compare with.</p><pre><code class="language-julia hljs">const alpha::Float64 = 2.5
const beta::Float64 = 5.0

f(x) = x^(alpha - 1) * (1 - x)^(beta - 1)

beta_proper(x) = pdf(Beta(alpha, beta), x)

l, u = 0, 1
fig, ax, p = lines(l..u, f, label=&quot;Unnormalized density&quot;)
lines!(ax, l..u, beta_proper, label = &quot;Actual beta distribution&quot;)
axislegend(ax)</code></pre><img src="index-c155ee69.svg" alt="Example block output"/><p>Lets define the objective and sampler. As the beta distribution is bounded on <span>$x \in [0, 1]$</span> we specify this in the domain argument when creating the sampler.</p><pre><code class="language-julia hljs">f_log(x) = log(f(x))
obj = ARS.Objective(f_log)

sam = ARS.ARSampler(obj, [0.2, 0.8], (0.0, 1.0))</code></pre><p>Lets visualize the samples as before.</p><pre><code class="language-julia hljs">samples = ARS.sample!(sam, 100000)

fig, ax, p = hist(samples, bins=100, label = &quot;Samples&quot;, normalization = :pdf)
lines!(ax, 0..1, beta_proper, label = &quot;Target&quot;, color = Cycled(2))
axislegend(ax)</code></pre><img src="index-9f7ff74d.svg" alt="Example block output"/><p>Of course, we can specify arbitrary bounds. Let&#39;s define the same beta distribution as above but truncated at <span>$[0.5, 1.0]$</span> and compare them with sampling from a truncated <code>Distributions.jl</code> distribution (with plotting code hidden for brevity).</p><pre><code class="language-julia hljs">sam_bounded = ARS.ARSampler(obj, [0.8], (0.5, 1.0))

samples_bounded = ARS.sample!(sam_bounded, 100000)

dist_bounded = truncated(Beta(alpha, beta), lower=0.5)

samples_true = rand(dist_bounded, 100000)</code></pre><img src="index-4824d95d.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="benchmarks/">Benchmarks »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 22 August 2025 06:25">Friday 22 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
